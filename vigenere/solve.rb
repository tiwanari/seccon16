# k: ????????????
# p: SECCON{???????????????????????????????????}
# c: LMIG}RPEDOEEWKJIQIWKJWMNDTSR}TFVUFWYOCBAJBQ
# k=key, p=plain, c=cipher, md5(p)=f528a6ab914c1ecf856a1d93103948fe

require 'digest/md5'

p = "SECCON{???????????????????????????????????}"
c = "LMIG}RPEDOEEWKJIQIWKJWMNDTSR}TFVUFWYOCBAJBQ"

table = "ABCDEFGHIJKLMNOPQRSTUVWXYZ{}"

# 最初の 7 個は SECCON{ を暗号化したものなので鍵がわかる
k = []
7.times do |i|
    k[i] = table[(table.index(c[i]) - table.index(p[i]) + table.size) % table.size]
end


puts "p: #{p}"
puts "c: #{c}"
puts "k: #{k}"


# p Digest::MD5.hexdigest(p)
md5 = "f528a6ab914c1ecf856a1d93103948fe"
